{% set title = "ุณุคุงู" %}
{% extends "base.html" %}
{% block content %}
<section class="question-shell">
  <div class="question-head">
    <div class="breadcrumb compact">
      <a href="/">ุงูุฑุฆูุณูุฉ</a>
      <span>โบ</span>
      {% if q.source == 'ai' %}
        <span>ุฃุณุฆูุฉ AI</span>
      {% else %}
        <span>ุฃุณุฆูุฉ ุณุงุจูุฉ</span>
        <span>โบ</span>
        <span>{% if q.exam_type == 'mid' %}ููุชุตู ุงููุตู{% elif q.exam_type == 'final' %}ููุงุฆู{% else %}ููุงููุง{% endif %}</span>
      {% endif %}
    </div>
    <a class="btn ghost" href="{% if q.source == 'ai' %}/subjects?source=ai{% else %}/subjects?source=past&exam={{ q.exam_type }}{% endif %}">ุฑุฌูุน ูููุงุฆูุฉ</a>
  </div>

  <div class="subject-header clean">
    <h2>{{ q.subject_name }}</h2>
    <div class="badges">
      {% if q.source == 'ai' %}
        <span class="badge">ุฃุณุฆูุฉ AI</span>
      {% else %}
        <span class="badge">ุฃุณุฆูุฉ ุณุงุจูุฉ</span>
        <span class="badge">{% if q.exam_type == 'mid' %}ููุชุตู ุงููุตู{% elif q.exam_type == 'final' %}ููุงุฆู{% else %}ููุงููุง{% endif %}</span>
      {% endif %}
    </div>
  </div>

  <div class="question-grid">
    <div class="card question-card">
      <div class="card-head">
        <span class="q-badge">ุณุคุงู #{{ q.id }}</span>
      </div>
      {% if q.image_path %}
        <img class="question-image" src="/static/{{ q.image_path }}" alt="ุตูุฑุฉ ุงูุณุคุงู" />
      {% endif %}
      {% if q.question_text %}
        <p class="question-text">{{ q.question_text }}</p>
      {% endif %}
    </div>

    <div class="card answer-card">
      <h3>ุงุฎุชุฑ ุงูุฅุฌุงุจุฉ</h3>
      <form method="post" action="/questions/{{ q.id }}/answer" class="choices modern">
        <label class="choice-pill">
          <input type="radio" name="choice" value="A" required />
          <span class="choice-letter">A</span>
          <span class="choice-text">{{ q.choice_a }}</span>
        </label>
        <label class="choice-pill">
          <input type="radio" name="choice" value="B" />
          <span class="choice-letter">B</span>
          <span class="choice-text">{{ q.choice_b }}</span>
        </label>
        <label class="choice-pill">
          <input type="radio" name="choice" value="C" />
          <span class="choice-letter">C</span>
          <span class="choice-text">{{ q.choice_c }}</span>
        </label>
        <label class="choice-pill">
          <input type="radio" name="choice" value="D" />
          <span class="choice-letter">D</span>
          <span class="choice-text">{{ q.choice_d }}</span>
        </label>
        <div class="answer-actions">
          <button class="btn" type="submit">ุฅุฑุณุงู ุงูุฅุฌุงุจุฉ</button>
          {% if prev_id %}
            <a class="btn ghost" href="/questions/{{ prev_id }}">ุงูุณุคุงู ุงูุณุงุจู</a>
          {% endif %}
          {% if next_id %}
            <a class="btn ghost" href="/questions/{{ next_id }}">ุงูุณุคุงู ุงูุชุงูู</a>
          {% endif %}
        </div>
      </form>

      {% if user %}
        <a class="link subtle" href="/questions/{{ q.id }}/result">ุนุฑุถ ุขุฎุฑ ูุชูุฌุฉ</a>
      {% endif %}

      <button class="btn ghost danger" type="button" onclick="document.getElementById('reportModal').classList.remove('hidden')">๐ฉ ุงูุฅุจูุงุบ ุนู ุฎุทุฃ</button>
    </div>
  </div>
</section>

<div id="reportModal" class="modal hidden">
  <div class="modal-card">
    <div class="modal-head">
      <h3>ุงูุฅุจูุงุบ ุนู ุฎุทุฃ</h3>
      <button class="icon-btn" type="button" onclick="document.getElementById('reportModal').classList.add('hidden')">ร</button>
    </div>
    <form method="post" action="/questions/{{ q.id }}/report" class="form">
      <label>ูุตู ุงูุฎุทุฃ</label>
      <textarea name="report_text" required></textarea>
      <label>ุงูุฅุฌุงุจุฉ ุงูุตุญูุญุฉ ุงูููุชุฑุญุฉ (ุงุฎุชูุงุฑู)</label>
      <select name="proposed_correct_choice">
        <option value="">--</option>
        <option value="A">A</option>
        <option value="B">B</option>
        <option value="C">C</option>
        <option value="D">D</option>
      </select>
      <label>ุดุฑุญ ููุชุฑุญ (ุงุฎุชูุงุฑู)</label>
      <textarea name="proposed_explanation"></textarea>
      <div class="modal-actions">
        <button class="btn" type="submit">ุฅุฑุณุงู ุงูุจูุงุบ</button>
        <button class="btn ghost" type="button" onclick="document.getElementById('reportModal').classList.add('hidden')">ุฅูุบุงุก</button>
      </div>
    </form>
  </div>
</div>
{% endblock %}
